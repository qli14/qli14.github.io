<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Gold Nanoparticles  Mie theory and FEM Simulation | Infinity-Eternity</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Gold Nanoparticles  Mie theory and FEM Simulation</h1><a id="logo" href="/.">Infinity-Eternity</a><p class="description">Blog of Qiang</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Gold Nanoparticles  Mie theory and FEM Simulation</h1><div class="post-meta">Jul 15, 2017</div><div class="post-content"><h4 id="Task-1-Derive-the-analytical-solution-Mie-theory"><a href="#Task-1-Derive-the-analytical-solution-Mie-theory" class="headerlink" title="Task 1. Derive the analytical solution (Mie theory)"></a>Task 1. Derive the analytical solution (Mie theory)</h4><ol>
<li><p>A good tutorial is <a href="http://yingsamuelhu.blogspot.com/p/mie-theory-for-multilayer-spheres.html" target="_blank" rel="noopener">here</a>.</p>
</li>
<li><p>The classical textbook by Bohren and Huffman.</p>
</li>
</ol>
<p><code>C. F. Bohren and D. R. Huffman, Absorption and Scattering of Light by Small Particles, 1998, vol. 1.</code></p>
<h4 id="Task-2-Calculate-the-scattering-and-absorption-cross-sections-in-Python"><a href="#Task-2-Calculate-the-scattering-and-absorption-cross-sections-in-Python" class="headerlink" title="Task 2. Calculate the scattering and absorption cross sections in Python"></a>Task 2. Calculate the scattering and absorption cross sections in Python</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Created on Sun Jul 16 13:46:58 2017</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@author: qli14</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> arange, pi, cos, real, imag, sqrt, genfromtxt</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy.special <span class="keyword">import</span> spherical_jn, spherical_yn</span><br><span class="line"></span><br><span class="line">plt.close(<span class="string">'all'</span>)</span><br><span class="line">plt.rcdefaults()</span><br><span class="line">plt.rc(<span class="string">'font'</span>,**&#123;<span class="string">'family'</span>:<span class="string">'sans-serif'</span>,<span class="string">'sans-serif'</span>:[<span class="string">'Arial'</span>],<span class="string">'size'</span>:<span class="number">10</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Define the Riccati-Bessel function psi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">psi</span><span class="params">(n,z)</span>:</span></span><br><span class="line">    y = z*spherical_jn(n,z)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"><span class="comment">## Define the derivative of psi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dpsi</span><span class="params">(n,z)</span>:</span></span><br><span class="line">    y = spherical_jn(n,z)+z*spherical_jn(n,z,derivative=<span class="keyword">True</span>)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"><span class="comment">## Define the Riccati-Bessel function xi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xi</span><span class="params">(n,z)</span>:</span></span><br><span class="line">    y = z*(spherical_jn(n,z)+<span class="number">1j</span>*spherical_yn(n,z))</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"><span class="comment">## Define the derivative of xi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dxi</span><span class="params">(n,z)</span>:</span></span><br><span class="line">    y = spherical_jn(n,z)+z*spherical_jn(n,z,derivative=<span class="keyword">True</span>) \</span><br><span class="line">    +<span class="number">1j</span>*(spherical_yn(n,z)+z*spherical_yn(n,z,derivative=<span class="keyword">True</span>))</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="comment">## Define the scattering coefficient an</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">an</span><span class="params">(n,m,x)</span>:</span></span><br><span class="line">    y = (m*psi(n,m*x)*dpsi(n,x)-psi(n,x)*dpsi(n,m*x)) \</span><br><span class="line">        /(m*psi(n,m*x)*dxi(n,x)-xi(n,x)*dpsi(n,m*x))</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"><span class="comment">## Define the scattering coefficient bn</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bn</span><span class="params">(n,m,x)</span>:</span></span><br><span class="line">    y = (psi(n,m*x)*dpsi(n,x)-m*psi(n,x)*dpsi(n,m*x))  \</span><br><span class="line">        /(psi(n,m*x)*dxi(n,x)-m*xi(n,x)*dpsi(n,m*x))</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="comment">## Import the complex refractive index of gold</span></span><br><span class="line">data = genfromtxt(<span class="string">'Johnson-gold-n-k.txt'</span>,delimiter=<span class="string">'\t'</span>,</span><br><span class="line">                  skip_header=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">wl = data[:,<span class="number">0</span>] <span class="comment"># wavelength in micrometer</span></span><br><span class="line">realn = data[:,<span class="number">1</span>] <span class="comment"># real part of the complex refractive index</span></span><br><span class="line">imagk = data[:,<span class="number">2</span>] <span class="comment"># imaginary part of the complex refractive index</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Wavelength in nanometer</span></span><br><span class="line">wl = wl*<span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Permittivity of the sphere</span></span><br><span class="line">epsilon = (realn+<span class="number">1j</span>*imagk)**<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Refractive index of the medium in which the sphere is embedded</span></span><br><span class="line">ReIndex = <span class="number">1.33</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Radius of the sphere in nanometer</span></span><br><span class="line">radius = <span class="number">50</span></span><br><span class="line"></span><br><span class="line">x = <span class="number">2</span>*pi*ReIndex/wl*radius <span class="comment"># dimensionless</span></span><br><span class="line"></span><br><span class="line">m = sqrt(epsilon)/ReIndex</span><br><span class="line">        </span><br><span class="line"><span class="comment">## The number of iterations in the series</span></span><br><span class="line">iteration = <span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## The total extinction efficiency</span></span><br><span class="line">Qext = <span class="number">0.0</span></span><br><span class="line">Qsca = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">1</span>,iteration+<span class="number">1</span>):</span><br><span class="line">    Qext = Qext + <span class="number">2</span>/x**<span class="number">2</span>*(<span class="number">2</span>*n+<span class="number">1</span>)*real(an(n,m,x)+bn(n,m,x))</span><br><span class="line">    Qsca = Qsca + <span class="number">2</span>/x**<span class="number">2</span>*(<span class="number">2</span>*n+<span class="number">1</span>)*(abs(an(n,m,x))**<span class="number">2</span>+abs(bn(n,m,x))**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">Qabs = Qext-Qsca</span><br><span class="line"></span><br><span class="line"><span class="comment">## Import the data from Comosl</span></span><br><span class="line">data2 = genfromtxt(<span class="string">'20170721-gold-nanoparticle-scattering-efficiency.txt'</span>,</span><br><span class="line">                   skip_header=<span class="number">1</span>)</span><br><span class="line">wl2 = data2[:,<span class="number">0</span>] <span class="comment"># wavelength in nanometer</span></span><br><span class="line">Qsca_comsol = data2[:,<span class="number">1</span>]</span><br><span class="line">Qabs_comsol = data2[:,<span class="number">2</span>]</span><br><span class="line">Qext_comsol = data2[:,<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">3.25</span>,<span class="number">2.00</span>))</span><br><span class="line"></span><br><span class="line">ax.plot(wl,Qext,<span class="string">'r--'</span>,linewidth=<span class="number">1</span>,markersize=<span class="number">3</span>,label=<span class="string">'Qext-M'</span>)</span><br><span class="line">ax.plot(wl2,Qext_comsol,<span class="string">'ro'</span>,linewidth=<span class="number">1</span>,markersize=<span class="number">3</span>,label=<span class="string">'Qext-C'</span>)</span><br><span class="line"><span class="comment">## Scaling factor of 1/n, n is the refractive index of the medium</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ax.plot(wl,Qsca,<span class="string">'b--'</span>,linewidth=<span class="number">1</span>,markersize=<span class="number">3</span>,label=<span class="string">'Qsca-M'</span>)</span><br><span class="line">ax.plot(wl2,Qsca_comsol,<span class="string">'bv'</span>,linewidth=<span class="number">1</span>,markersize=<span class="number">3</span>,label=<span class="string">'Qsca-C'</span>)</span><br><span class="line"></span><br><span class="line">ax.plot(wl,Qabs,<span class="string">'g--'</span>,linewidth=<span class="number">1</span>,markersize=<span class="number">3</span>,label=<span class="string">'Qabs-M'</span>)</span><br><span class="line">ax.plot(wl2,Qabs_comsol,<span class="string">'g+'</span>,linewidth=<span class="number">1</span>,markersize=<span class="number">3</span>,label=<span class="string">'Qabs-C'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Set xlim and ylim</span></span><br><span class="line">ax.set_xlim([<span class="number">450</span>,<span class="number">750</span>])</span><br><span class="line">ax.set_ylim([<span class="number">-0.3</span>,+<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set xticks and yticks</span></span><br><span class="line">plt.tick_params(axis=<span class="string">'both'</span>, direction=<span class="string">'in'</span>)</span><br><span class="line">ax.set_xticks(range(<span class="number">500</span>,<span class="number">710</span>,<span class="number">100</span>))</span><br><span class="line">ax.set_yticks(range(<span class="number">0</span>,<span class="number">10</span>,<span class="number">1</span>))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># Set labels</span></span><br><span class="line">ax.set_xlabel(<span class="string">'Wavelength(nm)'</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">'Scattering Efficiency Q'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Show the legend</span></span><br><span class="line">ax.legend(loc=<span class="string">'upper right'</span>,shadow=<span class="keyword">False</span>, frameon=<span class="keyword">False</span>, fontsize=<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Adjust the position of axis</span></span><br><span class="line">plt.subplots_adjust(left=<span class="number">0.11</span>,right=<span class="number">0.98</span>,bottom=<span class="number">0.20</span>,top=<span class="number">0.98</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># save figure</span></span><br><span class="line"><span class="comment">#fig.savefig('20170721-gold-nanoparticle-scattering-efficiency.svg')</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># show the figure</span></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<h4 id="Task-3-Simulate-the-scattering-with-finite-element-method-Comsol"><a href="#Task-3-Simulate-the-scattering-with-finite-element-method-Comsol" class="headerlink" title="Task 3. Simulate the scattering with finite element method (Comsol)"></a>Task 3. Simulate the scattering with finite element method (Comsol)</h4><ol>
<li>Comsol model exchange for <a href="https://www.comsol.com/community/exchange/215/" target="_blank" rel="noopener">Mie scattering.</a></li>
<li>When setting the energy flux, it’s important to consider the refractive index of the medium in which the nanoparticle is embedded.<br>$S=\frac{E_{0}^{2}}{2 \eta}=\frac{E_{0}^{2}}{2 \eta_0} \cdot n$</li>
</ol>
<h4 id="Task-4-Compare-and-discuss-the-numerical-and-analytical-results"><a href="#Task-4-Compare-and-discuss-the-numerical-and-analytical-results" class="headerlink" title="Task 4. Compare and discuss the numerical and analytical results"></a>Task 4. Compare and discuss the numerical and analytical results</h4><p>Mie theory and Comsol simulation.</p>
<p><img src="/2017/07/15/Gold-Nanoparticles-Mie-theory-and-FEM-Simulation/20170721-gold-nanoparticle-scattering-efficiency.svg" alt></p>
</div><div class="tags"><a href="/tags/Comsol-Mie-theory/">Comsol, Mie theory</a></div><div class="post-nav"><a class="pre" href="/2019/07/12/DIBL/">Drain Induced Barrier Lowering (DIBL)</a><a class="next" href="/2017/07/08/Comsol-Error-Messages/">Comsol Error Messages</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yoursite.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Electromagnetics/" style="font-size: 15px;">Electromagnetics</a> <a href="/tags/Comsol/" style="font-size: 15px;">Comsol</a> <a href="/tags/Comsol-Mie-theory/" style="font-size: 15px;">Comsol, Mie theory</a> <a href="/tags/Hexo-tutorial/" style="font-size: 15px;">Hexo tutorial</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/07/14/Test-equation-with-mathjax/">Test equation with mathjax</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/12/DIBL/">Drain Induced Barrier Lowering (DIBL)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/15/Gold-Nanoparticles-Mie-theory-and-FEM-Simulation/">Gold Nanoparticles  Mie theory and FEM Simulation</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/08/Comsol-Error-Messages/">Comsol Error Messages</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/28/front-matter/">Hexo - maupassant</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/25/How-to-insert-images-in-Hexo/">How to insert images in Hexo?</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/25/Au-nanoparticle/">Au nanoparticle</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/23/Dr Chenglong Zhao/">Plasmonics and EM Simulation</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/14/FEM_2D/">FEM for Dispersion Relation</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/20/RCS_units/">Units of Radar Cross Section</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">Infinity-Eternity.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>